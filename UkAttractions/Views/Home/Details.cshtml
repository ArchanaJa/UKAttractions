@model UKAttractions.Models.CountryAttraction

@{
    ViewBag.Title = "Details";
}
@*<link href="~/Content/MyStyle.css" rel="stylesheet" />*@
<div class="my-container" style="background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), url(@Url.Content(@Html.DisplayFor(m => m.Image).ToString())) no-repeat center center fixed;
    color: #e3eaf1;background-size: cover;">
    <div class="container">
        <section id="wrapper">
            <div class="row">
                <div class="col-md-12">
                    <div class="masthead">
                        <h1 class="database-header text-center">
                           
                            <span class="light text-primary animated fadeIn">@Html.DisplayFor(m => m.Name)</span>                            
                            
                        </h1>
                        <div class="row weather">
                            <div class="col-md-1 col-md-offset-6 Weathercol">
                                <ul class="list-unstyled">
                                    <li> <span id="r1c1" class="c1"></span></li>
                                    <li><span> <img id="r1c2" class="c2"></span></li>
                                    <li><span id="r1c3" class="c3"></span><i>°C</i></li>
                                    <li class="unit"><span id="r1c4" class="c4"></span><i>°C</i></li>
                                </ul>
                            </div>
                        
                            <div class="col-md-1 col-sm-1 Weathercol">
                                <ul class="list-unstyled">
                                    <li> <span id="r2c1" class="c1"></span></li>
                                    <li><span> <img id="r2c2" class="c2"></span></li>
                                    <li><span id="r2c3" class="c3"></span><i>°C</i></li>
                                    <li class="unit"><span id="r2c4" class="c4"></span><i>°C</i></li>
                                </ul>
                            </div>
                           
                        <div class="col-md-1 col-sm-1 Weathercol">
                            <ul class="list-unstyled">
                                <li> <span id="r3c1" class="c1"></span></li>
                                <li><span> <img id="r3c2" class="c2"></span></li>
                                <li><span id="r3c3" class="c3"></span><i>°C</i></li>
                                <li class="unit"><span id="r3c4" class="c4"></span><i>°C</i></li>
                            </ul>
                        </div>
                            <div class="col-md-1 col-sm-1 Weathercol">
                                <ul class="list-unstyled">
                                    <li> <span id="r4c1" class="c1"></span></li>
                                    <li><span> <img id="r4c2" class="c2"></span></li>
                                    <li><span id="r4c3" class="c3"></span><i>°C</i></li>
                                    <li class="unit"><span id="r4c4" class="c4"></span><i>°C</i></li>
                                </ul>
                            </div>
                            <div class="col-md-1 col-sm-1 Weathercol">
                                <ul class="list-unstyled">
                                    <li> <span id="r5c1" class="c1"></span></li>
                                    <li><span> <img id="r5c2" class="c2"></span></li>
                                    <li><span id="r5c3" class="c3"></span><i>°C</i></li>
                                    <li class="unit"><span id="r5c4" class="c4"></span><i>°C</i></li>
                                </ul>
                            </div>
                    </div>
                    <script>

                        window.onload= function() {
                            var theAPICall = "http://api.openweathermap.org/data/2.5/forecast/daily?q='@Html.DisplayFor(m => m.Post_Code)'&units=metric&APPID=f3216d67683dec9853217f94b282b8f9&cnt=7";
                            var myRequest = new XMLHttpRequest();

                            myRequest.open("GET", theAPICall, true);

                            myRequest.onload = function () {

                                if (myRequest.readyState == 4 && myRequest.status == 200) {

                                    var myData = JSON.parse(myRequest.responseText);
                                    console.log(myData);

                                    var D0 = new Date(myData.list[0].dt * 1000);
                                    var D1 = new Date(myData.list[1].dt * 1000);
                                    var D2 = new Date(myData.list[2].dt * 1000);
                                    var D3 = new Date(myData.list[3].dt * 1000);
                                    var D4 = new Date(myData.list[4].dt * 1000);

                                    var days = ["Sun", "Mon", "Tue", "Wed", "Thur", "Fri", "Sat"];

                                    //Day 1
                                    var weatherImage1 = "http://openweathermap.org/img/w/" + myData.list[1].weather[0].icon + ".png";
                                    document.getElementById("r1c1").innerHTML = days[D0.getDay()];
                                    document.getElementById("r1c2").src = weatherImage1;
                                    var a = myData.list[1].temp.max;
                                    document.getElementById("r1c3").innerHTML = a.toFixed();
                                    var b = myData.list[1].temp.min;
                                    document.getElementById("r1c4").innerHTML = b.toFixed();

                                    //Day 2
                                    var weatherImage2 = "http://openweathermap.org/img/w/" + myData.list[2].weather[0].icon + ".png";
                                    document.getElementById("r2c2").src = weatherImage2;
                                    document.getElementById("r2c1").innerHTML = days[D1.getDay()];
                                    var a = myData.list[2].temp.max;
                                    document.getElementById("r2c3").innerHTML = a.toFixed();
                                    var b = myData.list[2].temp.min;
                                    document.getElementById("r2c4").innerHTML = b.toFixed();
                                    //Day 3
                                    var weatherImage3 = "http://openweathermap.org/img/w/" + myData.list[3].weather[0].icon + ".png";
                                    document.getElementById("r3c2").src = weatherImage3;
                                    document.getElementById("r3c1").innerHTML = days[D2.getDay()];
                                    var a = myData.list[3].temp.max;
                                    document.getElementById("r3c3").innerHTML = a.toFixed();
                                    var b = myData.list[3].temp.min;
                                    document.getElementById("r3c4").innerHTML = b.toFixed();
                                    //Day 4
                                    var weatherImage4 = "http://openweathermap.org/img/w/" + myData.list[4].weather[0].icon + ".png";
                                    document.getElementById("r4c2").src = weatherImage4;
                                    document.getElementById("r4c1").innerHTML = days[D3.getDay()];
                                    var a = myData.list[4].temp.max;
                                    document.getElementById("r4c3").innerHTML = a.toFixed();
                                    var b = myData.list[4].temp.min;
                                    document.getElementById("r4c4").innerHTML = b.toFixed();

                                    //Day 5
                                    var weatherImage5 = "http://openweathermap.org/img/w/" + myData.list[5].weather[0].icon + ".png";
                                    document.getElementById("r5c2").src = weatherImage5;
                                    document.getElementById("r5c1").innerHTML = days[D4.getDay()];
                                    var a = myData.list[5].temp.max;
                                    document.getElementById("r5c3").innerHTML = a.toFixed();
                                    var b = myData.list[5].temp.min;
                                    document.getElementById("r5c4").innerHTML = b.toFixed();

                                }
                            }

                            myRequest.send();
                        }
                    </script>
                </div>
            </div>
          </div>

            <div class="row">
                <div class="col-md-12">
                    <div class="article animated fadeInUp col-md-offset-1">
                        <div class="verticle-rhythm col-md-11 ">
                            <img src="@Url.Content(@Html.DisplayFor(m => m.Image).ToString())" height="480" class="details-img">
                        </div>
                        <div class="col-md-6">
                            <h3>Located in @Html.DisplayFor(m => m.City), @Html.DisplayFor(m => m.Post_Code), UK</h3>
                        </div>

                        <div class="article-content">
                            <div class="row">
                                <div class="col-md-10">
                                    <p>@Html.DisplayFor(m => m.Description1)</p>
                                </div>
                           </div>
                            <div class="vertical-rhythm">
                                <div class="row">
                                    <div class="col-md-6 details-map">
                                        <div id="dvMap" style="height: 350px"></div>
                                        <script async defer
                                                src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCmMvTmEhXb5e_0oApgFZucVz9m9KzHdRg&callback=initMap">
                                        </script>
                                        @*<script src="https://code.jquery.com/jquery-3.2.1.min.js">
                                         </script>*@

                                        <script>
                                         function initMap() {

                                               // Creating a new variable to hold my lat and lng
                                             var ALocation = { lat: @Html.DisplayFor(m => m.Latitude), lng: @Html.DisplayFor(m => m.Longitude) };

                                              // Create a map object and specify the DOM element for display.
                                             var map = new google.maps.Map(document.getElementById("dvMap"), {
                                                 center: ALocation,
                                                 zoom: 16
                                                });
                                             var marker = new google.maps.Marker({
                                               position: ALocation,
                                                map: map
                                               });

                                            var popupAddress = "@Html.DisplayFor(m =>m.Name)<br/>";
                                                popupAddress += "@Html.DisplayFor(m => m.Post_Code)<br />";
                                            var infowindow = new google.maps.InfoWindow({
                                                content: popupAddress,
                                                maxWidth: 100
                                             });
                                      marker.addListener('click', function () {
                                      infowindow.open(map, marker);
                                     });
                                 }
                                        </script>
                                    </div>
                                </div>
                            </div>
                            
                        </div>
                        
                        <div class="row">
                            <div class="col-md-11">
                                <p>@Html.DisplayFor(m => m.Description2)</p>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-10">
                                <p>Link to website:<a href="@Html.DisplayFor(m=>m.LinktoAttrctn)" target="_blank"> @Html.DisplayFor(m => m.LinktoAttrctn)</a></p>
                            </div>
                            <div class="col-md-10">
                                <p>Tickets (Adult): £ @Html.DisplayFor(m => m.Cost)</p>
                            </div>
                        </div>

                        <div class="vertical-rhythm col-md-11">
                            <p>
                                @Html.ActionLink("Edit Record", "Edit", new { id = Model.Id }, new { @class = "btn btn-info pull-right" })
                                @Html.ActionLink("Back to List", "Index", null, new { @class = "btn btn-info" })
                                <br />
                                <br />
                                <br />
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
</div>


